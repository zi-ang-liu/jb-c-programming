# 環境構築

プログラミングの講義を受講するために，はじめに各⾃のコンピュータにC⾔語の開発環境を構築する必要があります．

環境構築には、**コンパイラ**と**エディタ**が必要です．本年度のプログラミングの講義では，WindowsコンピュータではMinGWを，MacコンピュータではClang/LLVMをそれぞれインストールした開発環境をもとに⾏います．エディタについては，Visual Studio Codeを使用します．

|   OS    | コンパイラ |      エディタ      |
| :-----: | :--------: | :----------------: |
| Windows |   MinGW    | Visual Studio Code |
|   Mac   | Clang/LLVM | Visual Studio Code |

以下の⼿順に従って，各⾃で開発環境を構築してください．

## MinGW，Command Line Tools for Xcode とは？

MinGW（ミン・ジー・ダブリュー，Minimalist GNU for Windows）は，C ⾔語などのコンパイラの環境を Windows 上で実現するためのフリーのアプリケーションの⼀つです．

MinGW(Wikipedia)：https://ja.wikipedia.org/wiki/MinGW

Xcode（エックスコード）とはmacOSにおける統合開発環境です．この環境で開発を行うためのコマンドラインツール群をCommand Line Tools for Xcodeと呼びます．

Xcode(Wikipedia)：https://ja.wikipedia.org/wiki/Xcode

それぞれフリーで使えるアプリケーションです．それぞれのインストール⽅法の概要を以下に⽰します．インストールについては参考となる情報がインターネットに多くありますので，以下の資料で分からない点がありましたら，まずはインターネットで調べてみてください．

## コンパイラのインストール

- [Windows の場合](#mingw-windows)
- [Mac の場合](#clang-mac)

### MinGW (Windows)

Windowsコンピュータについては，**MinGW**コンパイラを使用します．

以下の手順でMinGWをインストールしてください．

1. [MinGW-64のウェブサイト](https://www.mingw-w64.org​)を開きます．
2. 左側のメニューから**Downloads**を選択し、右側のメニューから**MinGW-W64-builds**を選択します．
3. [GitGub](https://github.com/niXman/mingw-builds-binaries/releases)にリンクされたページが開きます．
4. **x86_64-14.2.0-release-posix-seh-ucrt-rt_v12-rev0.7z** をダウンロード
5. ダウンロードファイルを解凍する。解凍したフォルダをCドライブ直下に移動する。

Windows(C:)の下に「**mingw64**」というフォルダができてればOK ({numref}`c-mingw-folder`)

```{figure} ./figures/env_setup/mingw_folder.png
---
height: 150px
name: c-mingw-folder
---
Windows(C:)の下に「mingw64」というフォルダができている
```

「mingw64」のフォルダの中身は{numref}`mingw-folder-inside`のようになっています。この中の「bin」にプログラムを必要なアプリケーションが入っている。

```{figure} ./figures/env_setup/mingw_inside.png
---
height: 200px
name: mingw-folder-inside
---
「mingw64」のフォルダの中身。
```

#### 環境変数の設定

以上の手順で、c:\MinGW に開発に関するプログラムがインストールされています．次にプログラムを開発するときにこれらのフォルダのアプリケーションを参照できるように、環境変数 PATH を設定します。

1. Windowsの検索バーに「環境変数」と入力し，**環境変数の編集**を選択します．
2. 「システムのプロパティ」下部の「環境変数」をクリックします．
3. 「システム環境変数」の中から「Path」を選択し，「編集」をクリックします．
4. 「新規」をクリックし，`C:\mingw64\bin`を追加し、「OK」をクリックします({numref}`add-env-var`)．

```{figure} ./figures/env_setup/add_env_var.png
---
height: 150px
name: add-env-var
---
環境変数の追加
```

以上でWindowsコンピュータにMinGWがインストールされました．

#### 確認

ターミナルを開いて以下のコマンドを実行してください．
（ターミナルは，Windowsの検索バーから**cmd**と入力して開くことができます．）

```bash
gcc --version
```

バージョン情報が表示されれば，MinGWがインストールされています．

もし「gcc ファイルが存在しない」という内容のメッセージが出た場合は，正しくインストールされていないか，環境変数が正しく設定されていないと考えられます．これまでの⼿順を再度確認してください．

#### 補足

`gcc` と⼊⼒して次のエラーメッセージが出る場合の対処法について記載します．

```bash
エラーメッセージ：「'gcc'は，内部コマンドまたは外部コマンド，操作可能なプログラムまたはバッチファイル
として認識されていません．」
```

原因：もっとも考えられる原因は，環境変数 PATH の設定です．

1. **環境変数の設定**をよく⾒て，正しく環境変数 PATH が設定されていることを確認してください．間違いがあったら修正し，再起動して再度 gcc の動作を確認してください．
2. 間違いがない場合は，以下の③以降の⼿順を⾏ってください．
3. エクスプローラを起動し，c:\MinGW\bin を開いてください．
4. エクスプローラでカレントフォルダが表⽰されている部分をコピーしてください．({numref}`find-path`)
5. コピーした内容を，**環境変数**-**ユーザ環境変数**-**環境変数名**の編集で，Path を選んで「**編集**」を押し，④でコピーした内容を貼りつけてください．
6. 再起動後，コマンドプロンプトを⽴ち上げてgcc の動作を確認してください．
   

```{figure} ./figures/env_setup/find_path.png
---
height: 150px
name: find-path
---
エクスプローラでカレントフォルダが表⽰されている部分をコピー
```

### Clang (Mac)

Macのコンピュータについては，**Clang/LLVM** コンパイラを使用します．

すでにインストールされているかどうかを確認するために，ターミナルを開いて以下のコマンドを実行してください．

（ターミナルは，**Finder**から**アプリケーション** -> **ユーティリティ** -> **ターミナル** で開くことができます。また，Spotlight検索で**terminal**と入力しても開くことができます。）

```bash
clang --version
```

バージョン情報が表示されれば，すでにインストールされています．次のセクションに進んでください．

インストールされていない場合は，ターミナルで以下のコマンドを実行してください．

```bash
xcode-select --install
```

コマンドを実行した後に表示される案内に従って操作を進めるとCommand Line Tools for Xcode がインストールされ，`clang`が使えるようになります．

確認のために，再度以下のコマンドを実行してください．

```bash
clang --version
```

## Visual Studio Codeのインストール

Visual Studio Code（以下，VS Code）は，Microsoftが提供するオープンソースのコードエディタです．C言語だけでなく，pythonやjavaなどの多くのプログラミング言語に対応しています．

### インストール

VS codeの[サイト](https://code.visualstudio.com/)からインストーラをダウンロードしてください．OSに合わせて**Download for Windows**または**Download for Mac**をクリックするとダウンロードが始まります．


<!-- ### 拡張機能のインストール

VS Codeを起動し，左側のアイコンから`Extensions`をクリックしてください．検索バーに`C/C++`と入力し，表示された`C/C++`をクリックしてください．`Install`ボタンをクリックするとインストールが始まります．

インストールが完了したら，VS Codeを再起動してください． -->

### VS Codeの日本語化(オプション)

VS Codeを起動し、以下の手順({numref}`vs-code-jp`)で日本語化をすることができます．

1. 左側のアイコンから**Extensions**をクリックしてください．
2. 検索ボックスにて「japanese」と打ち込む
3. 「Japanese Language Pack for Visual Studio Code」を選択
4. 「Install」を押す
   
インストールが完了したら一度閉じて開き直すと日本語化が反映される

```{figure} ./figures/env_setup/vs_code_jp.png
---
height: 200px
name: vs-code-jp
---
VS Codeの日本語化
```

## はじめてのプログラム

### 作業フォルダの作成

プログラミングによって，ソースプログラムと実行ファイルが作成され，頻繁に書き換えや消去が行われます．他の文書ファイルなどと混在して不注意でファイルを消さないためにも，予めソースプログラムや実行ファイルを保存する作業フォルダを作成しておきます．

#### Windows

Windows コンピュータでは，Cドライブ直下にプログラミング用の作業フォルダを作成してください．エクスプローラを開き，Cドライブ直下に右クリックし，**新規** -> **フォルダ**を選択します．フォルダの名前はわかりやすいものが良いので，ここでは，"GC"とつけることにします．この授業では常にこのフォルダ内で作業を行うことにすれば，他のファイルと混同することがありません．

#### Mac

Mac コンピュータでは，書類(Documents)フォルダ下にプログラミング用の作業フォルダを作成してください．Finderから書類(Documents)を開きます．次に，メニューバーにある**ファイル**メニューを開き， **新規フォルダ**を選びます．フォルダの名前はわかりやすいものが良いので，ここでは，"GC"とつけることにします．この授業では常にこのフォルダ内で作業を行うことにすれば，他のファイルと混同することがありません．

### 作業の概略

プログラムの作成は，大きく分けて

- エディタを用いたプログラムの作成 
- ターミナルでの gccによるコンパイル 
- プログラムの実行

に分けられます．

以降では，これらの作業を具体的に説明します．

### エディタを用いたプログラムの作成

以下の手順で，VS Codeを用いて.cファイルを作成してください．

1. Visual Studio Codeを起動します．
2. メニューバーから**ファイル** -> **フォルダを開く**を選択し，作業フォルダを開きます．
3. 左側のエクスプローラから，作業フォルダを右クリックし，**新しいファイル**を選択します．
4. test.cという名前でファイルを作成します．

test.cを作成したら，以下のプログラムを入力してください．

```c
#include <stdio.h>

int main(void){
    printf("Hello, World!\n");
    return 0;
}
```

プログラムの入力が終わったら，メニューバーから**ファイル** -> **保存**を選択し，保存してください．

### ターミナルでのコンパイル

VS Codeのターミナルを使って，作成したプログラムをコンパイルします．上部メニューバーから**ターミナル** -> **新しいターミナル**を選択すると，VS Codeのターミナルが開きます．

ターミナルが開いたら，以下のコマンドを入力してください．

```bash
gcc test.c -o test.exe
```

このコマンドは，**test.c**というファイルをコンパイルして，**test.exe**という実行ファイルを作成するためのものです．

### プログラムの実行

コンパイルが成功すると，作業フォルダに**test.exe**という実行ファイルが作成されます．ターミナルで以下のコマンドを入力して，プログラムを実行してください．

Windowsの場合は，以下のコマンドを入力してください．

```bash
test.exe
```

Macの場合は，以下のコマンドを入力してください．

```bash
./test.exe
```

ターミナルに`Hello, World!`と表示されれば，プログラムが正常に実行されています．